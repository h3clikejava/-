# Java性能优化方向

Java性能优化可以从以下几个方向去考虑。

## 代码优化
代码层面的优化方向包括：
**减少循环的层数**、**减少递归**、**在循环中少声明变量**、**少做分配和释放内存的操作**、**尽量把循环体内的表达式抽取到循环外**、**注意条件表达式中多个条件的判断次序**、**尽量在程序启动的时候把一些东西准备好**、**注意函数调用的开销（栈上开销）**、**注意临时对象的开销**、**小心使用异常（不要用异常做逻辑判断）**等。

## 前端优化
前端层面的优化方向包括：
**DNS负载均衡**、**CDN加速**、**减少单一用户连接数**、**减小图片大小**、**页面静态化（从内存读取数据，减少磁盘IO）**、**反向代理（缓存查询数据）**、**缓存**等。

## 服务器优化
服务器层面的优化方向包括：
**负载均衡(数据冗余、数据镜像、数据分区)**、**异步**、**节流阀（流量控制）**、**批量处理（合并多个请求，减少IO，充分利用MTU传输较多内容）**等。

其中`数据分区`通常有四种方法，每个方法各有侧重：
1. 把数据按照逻辑分类。比如火车票系统可以按照各铁路局分，可以按车型分，可以按始发地到达地分。
2. 把数据按照字段切分。把不常改数据放一个表，常改数据放另一个表。这样减少了单表的字段个数，提高单表查询速度；但是由于一条数据会被拆分给多个表存储，因此增加了查询难度。
3. 平均分表。第一种分区方案还是可能会导致部分表单数据庞大，因此通过主键ID范围来平分数据也是一种分区方法。
4. 同一数据分区。该方法是将数据分配到不同服务器上，例如一件商品有一万个库存，现用10台服务器存储，因此每台服务器上有一千个库存。

