# Java API调优 【面向对象和基础类型】

## 1. 用clone方法重复创建对象比用new更快

但是要注意系统默认实现的clone()只是浅拷贝，创建了一个地址引用而已。如果要实现深拷贝，需要自己复写clone方法，并且实现对象new创建。

## 2. 避免对Boolean判断

简单的来说就是直接用boolean变量判断，而不要用等于判定。如：

```
boolean flag = true;
if(flag == false) {} // 不要这样使用
if(!flag) {} // 推荐这样使用
```

这样做的好处一个是能让代码运行更快（生成字节码少5个字节），二个是让代码看起来简洁。

## 3. 用三目运算符替代if...else...

在一些简单的情况下，用三目运算符替代if...else...，这样会让代码看起来更简洁。这里需要注意的是，千万不要为优化而优化，JVM默认会对if...else...进行类似于三目运算的优化，因此该优化只是为了代码看起来更简洁。不要将复杂的if...else...方法体改为三目运算符，那样不仅起不到优化作用，对代码阅读和维护都会造成障碍。

## 4. 静态方法代替实例方法

这个情况其实需要具体分析。
**静态方法**：

* 速度很快，并且不需要创建对象实例；
* 静态方法**不能被继承**，因此无法实现多态；
* 静态方法会在类加载初期就被记录在方法区中；
* 只能访问静态变量和静态方法；

**实例方法**：

* 需要消耗更多的系统资源，需要维护一张虚拟函数导向表；
* 动态绑定，当其被调用的时候加载进方法区；

资料显示过多的，甚至全是静态方法对程序不会造成性能影响。理论上不依赖内部成员变量的所有方法都应该声明为static的。

## 5. 建议使用局部变量

方法调用时，其传递的参数和局部变量都保存在栈中，因此访问速度很快。而静态变量，成员变量都保存在堆中，相对而言读取速度较慢。

## 6. 布尔运算代替位运算
用 `&&`、`||`替代`&`、`|`。布尔运算在判定条件已经成立的时候不会继续执行剩下的判断，但是位运算不会，会导致计算。

## 7. 显示的对不需要用到的对象置空
在内存章节我们就提到过，在函数体内对于不用的对象直接置Null可以节省内存。在一些极端情况下，显示置Null还能提高代码性能，因此对于不需要用的的对象，及时置Null是有必要的。

```
// 在单位时间内，将a置空比不置空可以创建更多的对象实例
private static Object a;
public static void test() {
    int n = 0;
    while(true) {
        // a = null;
        a = new SizeableObject();
        n++;
    }
}
```

